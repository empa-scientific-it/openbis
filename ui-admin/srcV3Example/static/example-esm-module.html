<!DOCTYPE html>
<html lang="en">
  <head>
    <title>V3 API bundle test</title>

    <!-- ES module version of the API -->

    <script type="module">
      import V3API from '/V3API.esm.js'

      export function useV3API() {
        var facade = new V3API.openbis(
          'http://localhost:8888/openbis/openbis/rmi-application-server-v3.json'
        )

        facade
          .login('admin', 'password')
          .done(function (sessionToken) {
            return facade
              .searchSpaces(
                new V3API.SpaceSearchCriteria(),
                new V3API.SpaceFetchOptions()
              )
              .done(function (searchResult) {
                alert(
                  'Found spaces: ' +
                    searchResult.getObjects().map(function (space) {
                      return space.getCode()
                    })
                )
              })
          })
          .fail(error => {
            alert('Failed with error: ' + JSON.stringify(error))
          })
      }

      window.useV3API = useV3API
    </script>
  </head>
  <body>
    <div id="root">
      <button onclick="{useV3API();}">Use ESM V3 API</button>
    </div>
  </body>
</html>
